<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <meta property="og:title" content=" Generating placeholder images with Pixabay, jq, and curl |  CodeSections"> 
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content=" Generating placeholder images with Pixabay, jq, and curl |  CodeSections">
    <meta name="twitter:image:src" content="https://www.codesections.com/codesections_logo.png"> 
    <meta property="og:type" content="article">
    <meta property="og:url" content="www.codesections.com">
    <meta property="og:site_name" content="CodeSections">
    <meta property="article:section" content="Article Section">
    <meta property="og:image" itemprop="image primaryImageOfPage" content="https://www.codesections.com/codesections_logo_large.png"><meta name="og:description" content="The personal website and blog of Daniel Long Sockwell, a lawyer-turned-programmer with an interest in web development, open source, and making things as simple as possible.">
    <meta name="description" content="The personal website and blog of Daniel Long Sockwell, a lawyer-turned-programmer with an interest in web development, open source, and making things as simple as possible.">
    <meta name="twitter:description" content="The personal website and blog of Daniel Long Sockwell, a lawyer-turned-programmer with an interest in web development, open source, and making things as simple as possible.">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="theme-color" content="#d9d9d9">
    <link rel="canonical" href="https://www.codesections.com/blog/guide-to-placeholder-images">
    <title>
       Generating placeholder images with Pixabay, jq, and curl |  CodeSections 
    </title>
    <style> 
      /*==================================*\
        ##All CSS for this page
      \*==================================*/
      
      /*  Theme colors
       *  #cde     pastel blue (note boxes)
       *  #000     true black (site header)
       *  #4F82BB; Dark Blue  (Nav bar)
       *  #223     near black (text & logo)
       *  #fff     white (menu text)
       *  #07e     sky blue (links)
       *  #dfe2e5  Light grey (tables & borders)
       */
      html {
        font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Oxygen-Sans,
          Ubuntu,Roboto,Cantarell,"Helvetica Neue",sans-serif;
        font-size: 17px;
        color: #223; /*near black*/
      }
      a {
        color: #0071F0; /*sky blue*/
        text-decoration: none;
      }
      .hidden {
        display: none;
      }
      
      .nav-bar {
        position: fixed;
        z-index: 1;
        left: 0;
        width: 100%;
        padding: 0;
        background-color: #4F82BB; /*Dark Blue*/
        box-shadow: 0 3px 6px rgba(0, 0, 0, .3);
        top: 0;
      }
      .nav-bar__container {
        display: flex;
        max-width: 700px; /*max comfortable line length*/
        padding-left: 8px;
        padding-right:8px;
        margin: auto;
        justify-content: space-between;
      }
      .nav-bar__btn {
        position: relative;
        cursor: pointer;
        background-color: inherit;
        height: 1.25em;
        display: inline-block;
      }
      .nav-bar__btn a {
        color: white;
      }
      .nav-bar__btn a:after {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 0;
        content: "";
        transition: all 0.4s ease;
        border-top: 3px solid #223; /*near black*/
      }
      .nav-bar__btn:not(.nav-bar__btn--icon) a:hover:after {
          width: 100%;
      }
      .svg__logo {
        height: 40px;
        width: 40px;
      }
      .svg__logo--background {
        fill: #4F82BB;
      }
      @media (max-width: 599px) { /*Phone only*/
        .nav-bar__btn {
          font-size: 1.382em;
          line-height: 1.382em;
        }
      }
      @media (min-width: 600px) {  /*Tablet-portrait & up*/
        .nav-bar__btn {
          font-size: 2em;
        }
        .svg__logo {
          height: 64px;
          width: 64px;
        }
      }
      
      /*==================================*\
        ##Main content
      \*==================================*/
      .content-main{
        min-height: calc(100vh - 100px - 3em);
        /*  This equals [fullscreen - (top margin) -
         *  (space for the 2-line footer, with margin)]*/
        max-width: 700px; /*  Match nav container width*/
        margin: 3em auto auto auto;
        padding: .1em;
        font-size: 1.15em;
        line-height: 1.6em;
        color: #444;
      }
      .content-main h1 {
        font-size: 1.7em;
        margin-top: .5em;
        margin-bottom: .5em;
        line-height: 1.1em;
      }
      .content-main h2 {
        margin-top: .25em;
      }
      .content-main blockquote {
          
          border-left: #dfe2e5 solid 7px;
          padding-left: .5em;
          padding-right: .5em;
          margin-left: 40px; /* default */
          width: calc(100% - 1em - 40px);
      }
      @media (min-width: 600px) {
        .content-main h2 {
          margin-top: 1em;
        }
      }
      .content-main p {
        margin-bottom: 1.75em;
      }
      .content-main p code,
      .content-main ul code {
        color: #c0341d;
        background-color: #fbe5e1;
        border-radius: 3px;
      }
      .content-main pre {
        overflow-x: auto;
        padding: .5em;
        line-height: 1.3em;
      }
      .content-main img {
        width: 100%;
      }
      .content-main .give-border img {
        border: #dfe2e5 solid 1px;
      }
      .page-nav__earlier {
        float: right;
      }
      
      /*==================================*\
        ##Footer
      \*==================================*/
      .footer {
        margin-top: 2em;
        text-align: center;
      }
      .footer ul {
        margin: 5px;
        padding: 0;
      }
      .footer li {
        display: inline-block;
      }
  
</style>
  </head>

  <body>
    <nav class="nav-bar">
      <ul class="nav-bar__container">
        <li class="nav-bar__btn"><a href="/">Home</a></li>
        <li class="nav-bar__btn"><a href="/contact">Contact</a></li>
        <li class="nav-bar__btn nav-bar__btn--icon">
            <!-- site logo, as an inline SVG because that loads faster-->
            <a href="/"><span class="hidden">Home</span>
            <svg class="svg__logo" viewBox="0 0 100 120" stroke-width="1px"
              stroke="#000" height="100" width="100">
              <title>Logo image/link to homepage</title>
              <circle class="svg__logo--background" fill="#fff"
              stroke="none" cx="50" cy="35" r="69"/>
              <path d="M -9,50 25,10 V 25 L 4,50 25,75 v 15 z"/>
              <path d="m 49,92 c 12,0 20,-8 20,-17 0,-7 -3,-11 -7,-13 5,-3 7,-7
              7,-12 0,-18 -30,-12 -30,-25 3,-11 17,-7 26,-3 l 2,-7 c -13,-7
              -35,-4 -35,11 0,6 3,11 9,14 -5,2 -9,7 -9,13 0,16 29,11 29,24 0,5
              -6,8 -13,8 -6,0 -11,-4 -15,-6 l -2,7 c 5,3 11,6 18,6 z"/>
              <path d="M 110,50 75,90 V 75 L 98,50 75,25 V 10 Z"/>
              <ellipse class="svg__logo--background" ry="8.5" rx="11.5"
              cy="51" cx="50" fill="#fff"/>
            </svg>
            </a>
        </li>
        <li class="nav-bar__btn"><a href="/blog">Blog</a></li>
        <li class="nav-bar__btn"><a href="/projects">Projects</a></li>
      </ul>
    </nav>
    <section class="content-main">
  
    
  <h1>Generating placeholder images with Pixabay, jq, and curl</h1>
  <p>Just recently, I found myself in need of several hundred pictures.  I'm working on a fairly large-scale app, and I want to be able to test its server infrastructure under load.  In my case, that means uploading a decent number of images to Amazon's S3 servers and testing how the app's performs holds up.</p>
<p>So, where to get several hundred reasonably decent pictures, preferably with as little work as possible?</p>
<h2 id="licensing-difficulties">Licensing Difficulties</h2>
<p>I asked around, and several of my colleagues recommended <a href="https://unsplash.com/">Unsplash</a>.  In a lot of ways, that would be perfect—they have gorgeous photos, and an easy-to-use API.  There's just one problem: The Unsplash API <a href="https://medium.com/unsplash/unsplash-api-guidelines-hotlinking-images-6c6b51030d2a">expressly requires</a> all images to be hotlinked back to their servers.  As they explain:</p>
<blockquote>
<p>Downloads and views are one of the main motivations for many Unsplash contributors. By opening up the Unsplash API to 3rd party applications their photography is seen and used by more users which inspires them to contribute more, new contributors to join, and an even better library for you and your community of creatives.</p>
<p>When displaying Unsplash images, you should use the urls property returned by the API on all of the API photo objects.</p>
</blockquote>
<p>That makes a certain amount of sense.  (I suspect they might also be harvesting the data for advertising purposes too, based on a closer reading of their ToS—but, either way, it's their product and they make the rules.)</p>
<p>So, if Unsplash is out, what does that leave us with?</p>
<h2 id="other-options">Other Options</h2>
<p>Well, there's always <a href="placekitten.com/">placekitten</a>.  But, just for the sake of argument, let's assume that we'd like somewhat realistic data in our app and that we're building an app that <em>isn't</em> kitten-centric (I know, what is the Internet coming to!).</p>
<p>I investigated a few other options, but none of them quite worked.  I looked at <a href="https://tools.wmflabs.org/magnus-toolserver/commonsapi.php">Wikimedia Commons</a> (limited API, no way to programmatically filter based on license); <a href="https://www.pexels.com/">Pexels</a> (no public access to API—only after requesting access); <a href="https://www.flickr.com/creativecommons/">Flicker CC</a> (API is exclusively non-commercial); <a href="http://placeimg.com/">PlaceImage</a> and <a href="http://lorempixel.com/">LoremPixel</a> (Good APIs but very limited image selection).</p>
<h2 id="the-best-choice">The Best Choice</h2>
<p>After sorting through the contenders, I finally found a site that would work perfectly: <a href="https://pixabay.com/">Pixabay</a>, which has a great (although not 100% user-friendly) API and allows full use of their images on external server.  And everything there is perfectly open-source.  Thanks to <a href="https://fosstodon.org/@colomar">Thomas Pfeiffer</a> for pointing me in the right direction, by the way.</p>
<p>Having settled on the source of our images, how do we actually go about pulling some down?  Let's code!</p>
<p><a name="continue-reading"></a></p>
<h2 id="how-to-use-pixabay">How To Use Pixabay</h2>
<p>First, we need to grab a Pixabay API key as described in <a href="https://pixabay.com/api/docs/">their docs</a>.  This does require registering for a (free) account, but shouldn't take more than a minute.</p>
<p>Next, we'll query the API, and return some JSON describing our images.  To do this, we'll use the <code>https://pixabay.com/api/</code> route with the <code>curl</code> command.  For example, you could do this:</p>
<pre style="background-color:#002b36;">
<span style="color:#268bd2;">curl </span><span style="color:#839496;">&quot;</span><span style="color:#2aa198;">https://pixabay.com/api/?key=YOUR_API_KEY&amp;image_type=photo&amp;category=buildings&amp;per_page=200&amp;page=1</span><span style="color:#839496;">&quot; </span><span style="color:#657b83;">&gt;</span><span style="color:#839496;"> response.json
</span></pre>
<p>As you can probably tell, that query filters based on the &quot;building&quot; category.  You can filter on whatever category you'd like, or even perform a search if you want more detailed results.  Check out the <a href="https://pixabay.com/api/docs/">API docs</a> for full details on the available fields.</p>
<p>That will save a fairly long string of JSON to your the <code>response.json</code> file.  It gives you all the data you need to pull the images, but it's a bit much to work with.</p>
<p>Fortunately, there's a great command-line tool called <a href="https://stedolan.github.io/jq/">jq</a> that can help you filter this response—if you don't already know about it, now's a great time to learn.</p>
<p>Jq has several powerful filters, but right now we'll just be using a basic one:
we want the <code>webformatURL</code> value for each of the images, and we want to save that into a separate file.  To do this, all we need is:</p>
<pre style="background-color:#002b36;">
<span style="color:#268bd2;">jq </span><span style="color:#839496;">&#39;</span><span style="color:#2aa198;">.hits[]webformatURL</span><span style="color:#839496;">&#39; </span><span style="color:#657b83;">&lt;</span><span style="color:#839496;"> images.json </span><span style="color:#657b83;">&gt;</span><span style="color:#839496;"> urls.json
</span></pre>
<p>This gets us a file full of lines like:</p>
<pre style="background-color:#002b36;">
<span style="color:#839496;">&quot;https://pixabay.com/get/ea32b70e2df5043ed1584d05fb1d4796e57fe6d01eb40c4090f4c378a2e9b1b1df_640.jpg&quot;
</span></pre>
<p>Each line links to a particular image just like this one:</p>
<p><img src="https://www.codesections.com/blog/guide-to-placeholder-images/img.jpg" alt="Placeholder image" /></p>
<p>For our next step, however, we'll need the bare URLs, so let's quickly strip out the quotation marks.  Just open up your favorite text editor and remove the quotes—in my case that means firing up Vim and running <code>:%s/&quot;//g</code>, but use whatever you're comfortable with.</p>
<p>After all that, we just need to loop through the list and make a curl request for each line—and then save each file with a unique name.  We can do that with a bit of bash:</p>
<pre style="background-color:#002b36;">
<span style="color:#268bd2;">i</span><span style="color:#657b83;">=</span><span style="color:#2aa198;">0</span><span style="color:#859900;">;
</span><span style="color:#859900;">while read</span><span style="color:#839496;"> LINE</span><span style="color:#859900;">;
</span><span style="color:#839496;">  </span><span style="color:#859900;">do </span><span style="color:#268bd2;">curl </span><span style="color:#839496;">&quot;</span><span style="color:#859900;">$</span><span style="color:#268bd2;">LINE</span><span style="color:#839496;">&quot; </span><span style="color:#657b83;">&gt;</span><span style="color:#839496;"> img</span><span style="color:#859900;">$</span><span style="color:#268bd2;">1</span><span style="color:#839496;">.jpg</span><span style="color:#859900;">;
</span><span style="color:#839496;">  </span><span style="color:#268bd2;">i</span><span style="color:#657b83;">=</span><span style="color:#859900;">$</span><span style="color:#2aa198;">((</span><span style="color:#859900;">$</span><span style="color:#268bd2;">i</span><span style="color:#657b83;">+</span><span style="color:#6c71c4;">1</span><span style="color:#2aa198;">))</span><span style="color:#859900;">;
</span><span style="color:#859900;">done </span><span style="color:#657b83;">&lt;</span><span style="color:#839496;"> urls.json
</span></pre>
<p>And that should get you 200 files—rinse and repeat for as many files as as you need!</p>
<p>And, with just a few minutes and a few lines of code, you have a full selection of placeholder images on whatever topic you'd like.</p>


  <div>
    
    
  </div>

  
</section>
    
  <footer class="footer">
    <ul>
      <li>© 2020 |</li>
      <li><a href="/contact">Contact</a> |</li>
      <li><a href="/license/">Few Rights Reserved</a> |</li>
      <li><a href="/rss.xml" type="application/rss+xml"> RSS</a></li>
    </ul>
    <ul>
      <li><a href="/privacy">Privacy Guarantees</a> |</li>
      <li><a href="https://github.com/codesections-personal/codesections">
        Source Code for codesections.com</a>
      </li>
    </ul>
  </footer>

  
</body>
</html>
